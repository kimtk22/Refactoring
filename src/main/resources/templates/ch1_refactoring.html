<!DOCTYPE html>
<html>
	<head>
	<meta charset="UTF-8">
	<title>Insert title here</title>
	<script type="text/javascript">
		/*
		연극을 외주로 받아 공연하는 극단의 공연료 및 포인트 산출 프로그램
		
		요구사항
		1. 연극의 장르와 관객 규모를 기초로 비용을 책정한다.
		2. 장르는 비극(tragedy), 희극(comedy) 두가지가 있다.
		3. 공연료, 포인트 산출해야한다.
		*/
		
		// 연극 정보	
		palys = { 
			"hamlet": {"name": "Hamlet", "type": "tragedy"}, 
			"as-like": {"name": "As You Uke It", "type": "comedy"}, 
			"othello" : {"name": "Othello", "type": "tragedy"} 
		}
		
		// 외주 요청 정보(청구서)
		invoices = [
			{
				"customer": "BigCo",
				"performances" : [
					{ "playID": "hamlet", "audience": 55 },
			        { "playID": "as-like", "audience": 35 },
			        { "playID": "othello", "audience": 40 }
				]
			}
		]
			  		
		
		function statement(invoice, plays) {
			  // 총 금액
			  let totalAmount = 0;
			  
			  // 포인트
			  let volumeCredits = 0;
			  
			  // 청구서
			  let result = `청구내역 (고객명: ${invoice.customer})\n`;
			  const format = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 2 }).format;
				
			  for (let perf of invoice.performances) {
			    const play = plays[perf.playID];
			    
			    // 총 금액 계산
			    let thisAmount = amountFor(perf, play);
		
			    // 포인트를 적립한다.
			    // 희극 관객 5명마다 추가 포인트를 제공한다.
			    volumeCredits += Math.max(perf.audience - 30, 0);
			    if ('comedy' === play.type) {
			      volumeCredits += Math.floor(perf.audience / 5);
			    }
		
			    // 청구 내역을 출력한다.
			    result += `${play.name}: ${format(thisAmount / 100)} ${perf.audience}석\n`;
			    totalAmount += thisAmount;
			  }
			  
			  
			  result += `총액 ${format(totalAmount / 100)}\n`;
			  result += `적립 포인트 ${volumeCredits}점\n`;
		
			  return result;
			}
		
		function amountFor(perf, play){
			// 총 금액 계산
		    let thisAmount = 0;
		    switch (play.type) {
		      case 'tragedy':
		        thisAmount = 40_000;
	
		        if (perf.audience > 30) {
		          // 30명 이상일 경우, 한명당 1000 추가
		          thisAmount += 1_000 * (perf.audience - 30);
		        }
		        break;
		      case 'comedy':
		        thisAmount = 30_000;
	
		        if (perf.audience > 20) {
		          // 20명 이상일 경우, 1000 + 한명당 500 추가
		          thisAmount += 10_000 + 500 * (perf.audience - 20);
		        }
		        thisAmount += 300 * perf.audience;
		        break;
	
		      default:
		        throw new Error(`알 수 없는 장르: ${play.type}`);
		    }
		    
		    return thisAmount;
		}
		
	
	
	</script>
</head>
<body>

</body>
</html>